## 数据格式

**原始数据**格式：

| 考勤号码 | 姓名 | 日期     | 时间1 | 时间2 | 时间3 | ...   |
| -------- | ---- | -------- | ----- | ----- | ----- | ----- |
| 1        | xxx  | 2099/1/1 | 7:06  | 11:15 | 13:52 | 18:00 |
| 1        | xxx  | 2099/1/2 | 7:03  | 11:12 | 14:01 | 18:06 |
| ... |

匹配后：

1. 迟到早退用<span style="color: rgb(0,0,255);">蓝色</span>字体标出
2. 早来晚走用<span style="color: rgb(255,0,0);">红色</span>字体标出
3. 漏卡用<span style="background: rgb(255,255,0);">黄色</span>背景填充
4. 无效记录用<span style="background: rgb(200,200,200);">灰色</span>背景填充



**考勤统计条**格式：

| 上月存息 | 本月出勤 | 本月例休 | 本月休假 | 剩余年假 | 请假 | 计薪 | 迟到/早退 | 漏打卡 | 全勤 | 上月存钟 | 本月加钟 | 本月补钟 | 本月存钟 |
| -------- | -------- | -------- | -------- | -------- | ---- | ---- | --------- | ------ | ---- | -------- | -------- | -------- | -------- |
|          |          |          |          |          |      |      |           |        |      |          |          |          |          |

如果把`2099年1月考勤确认表.xls`（注意命名时除了年、月可以改以外其他都不能变，否则无法识别）放在文件夹下任意位置（可以在子文件夹中），则可以自动填写上月存息和上月存钟（其他部分可以用公式的会填成公式)

查找考勤确认表时的依据是姓名（从文件内容获取）、年月（从文件名解析出），如果有多个考勤确认表而且这些全部都重复了，不能保证谁覆盖谁



生成的**考勤确认表**格式：

| 部门 | 姓名 | 存息 | 存钟 | 漏打卡 | 全勤奖 | 备注 |
| ---- | ---- | ---- | ---- | ------ | ------ | ---- |
|      |      |      |      |        |        |      |



## 如何更改

查找班次实现了两种方法，一种是一个子文件夹名对应一层Map，另一种是直接通过文件名作为key直接查找，可以在`checkin.Executor:113`中更改最后的参数`true/false`来变更，默认情况下，拖入文件夹到班次匹配的按钮上进行的全匹配（要求子文件夹名及其层级结构对应），拖入文件到班次匹配的按钮上进行的是非全匹配（不检测子文件夹名，只看文件名）



## 以后版本的目标

改进更改班次时间的图形化界面，添加设置查找班次方法（是否路径全匹配）的图形化界面

添加配置文件

把需要人工填写的工时、出勤记1、备注、加补钟都用代码填写（其实前三已经可以用Excel公式填写了，只不过准确率不够）

增加判断休半日的功能

增加通宵班支持，对于0:00下班的情况，如果早退是在今天24:00之前打卡，而正常打卡又会在0:00后打卡，而一行记录只记录一天的打开情况，目前还没有办法跨天判断，如果支持了占位时间，可以暂时通过增加班次的方式解决



## 存在的Bug

`Easyexcel`对于表格第一行无法读写，读入时第一行是表头不会影响数据处理，写出虽然也不影响写出的数据，但是就没有了表头。这个Bug由框架产生，以后可能会考虑转成其他框架（但是JAVA的其他Excel操作框架大部分会有OOM的问题，也可以直接用阻塞队列优化POI自己做一个框架）或用其他语言的其他框架实现

如果文件夹名和文件名重复，由于使用HashMap存储，key不能重复，所以会有其中一个无法使用

如果指定了某人的特定班次，由于第一次匹配的时候不知道所有人的人名，排除列表只能排除读到过内存中的人名，所以第一次匹配无法完美排除某人特定的班次（只能排除前面读到过内存的人的特定班次），可以通过预先读一遍所有文件实现，但是太耗费性能，所以如果想完美排除特定的班次，可以通过匹配第二次实现


